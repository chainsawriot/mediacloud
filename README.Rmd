---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# mediacloud

<!-- badges: start -->
<!-- badges: end -->

R wrapper package for the [MediaCloud](https://mediacloud.org/) API.

## Installation

You can install the development version of mediacloud from GitHub with:

```{r eval=FALSE}
#install.packages("remotes")
remotes::install_github("joon-e/mediacloud")
```


## Usage

```{r}
library(mediacloud)
```

### Authentication

Register for a MediaCloud account [here](https://explorer.mediacloud.org/#/user/signup). The API key can be passed directly to functions with the `key` argument. If no key is provided, then the package will look for one in the environment variable `MEDIACLOUD_API_KEY`. Thus, the easiest way to authenticate is to store your key using `Sys.setenv()`:

```{r eval=FALSE}
Sys.setenv(MEDIACLOUD_API_KEY = "YOUR_KEY_GOES_HERE")
```

### Search media

Search for media outlets with `search_media()`:

```{r cars}
search_media(tag = "Germany___National", n = 10)
```

### Search stories

Search for stories with `search_media()`, for example by full `text`, `title`, and/or `media_id`, and filter stories published after `after_date` and/or before `before_date`:

```{r}
stories <- search_stories(title = "dogecoin", media_id = c(19831, 38697), after_date = "2021-05-01")
stories
```
### Get word matrices

Get Tidytext-style word matrices associated with those stories:

```{r}
wm <- get_word_matrices(stories_id = stories$stories_id)
wm
```
These can be tranformed to Quanteda-style DFMs using `tidytext::cast_dfm()`:

```{r}
tidytext::cast_dfm(wm, stories_id, word_stem, word_counts)
```
